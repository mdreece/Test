SAGETECHTOOLv1.0.8B

@echo off


SET MYFILE="C:\SageUtilities\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%
cls
SET MYFILE="C:\SageUtilities\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%  
cls
DEL "C:\SageUtilities\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
clscls
DEL "C:\SageUtilities\QuicktouchUtilities\2.RUNSECOND-SAGETOOL-SETUP.lnk"

cls

SET MYFILE="C:\SageUtilities\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%
cls
SET MYFILE="C:\SageUtilities\QuicktouchUtilities\2.RUNSECOND-SAGETOOL-SETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%  
cls
DEL "C:\SageUtilities\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
cls
DEL "C:\SageUtilities\QuicktouchUtilities\2.RUNSECOND-SAGETOOL-SETUP.lnk"
cls

SET MYFILE="C:\Program Files\QuicktouchUtilities\1.RUNFIRST-QTTOOLSSETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%
cls

SET MYFILE="C:\Program Files\QuicktouchUtilities\2.RUNSECOND-SAGETOOL-SETUP.lnk"
cls
IF EXIST %MYFILE% DEL /F %MYFILE%
cls



@echo off
Title "SAGE TECH TOOL SECURITY"
:start01
====================================================================================
:sage
color 7
@echo off
echo.
echo              +    ####      ###      ######    ######  +                    
echo              +  ####       #####   ##     ##   ###     +                    
echo              +   ######   ### ###  ##   #####  #####   +                    
echo              +      ###  ######### ##     ##   ###     +                    
echo              +   ####   ###     ###  ######    ######  +                    
echo.
echo    [ DRIVERSE SUPPORT : 2022 ]                                                 
echo.             v1.0.8B
echo.


====================================================================================


@echo off
setlocal

set /P "=password" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls

IF "%Password%"=="sage1234" goto :start

color C

echo A
ping localhost -n .10 >nul
cls
echo AH
ping localhost -n .10 >nul
cls
echo AH A
ping localhost -n .10 >nul
cls
echo AH AH
ping localhost -n .10 >nul
cls
echo AH AH A
ping localhost -n .10 >nul
cls
echo AH AH AH
ping localhost -n .10 >nul
cls
echo AH AH AH,
ping localhost -n .10 >nul
cls
echo AH AH AH, Y
ping localhost -n .10 >nul
cls
echo AH AH AH, Yo
ping localhost -n .10 >nul
cls
echo AH AH AH, You
ping localhost -n .10 >nul
cls
echo AH AH AH, You D
ping localhost -n .10 >nul
cls
echo AH AH AH, You Di
ping localhost -n .10 >nul
cls
echo AH AH AH, You Did
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn'
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't S
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Sa
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say T
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say Th
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The M
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Ma
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Mag
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magi
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic W
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Wo
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Wor
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Word
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Word.
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Word..
ping localhost -n .10 >nul
cls
echo AH AH AH, You Didn't Say The Magic Word...
ping localhost -n 3 >nul
cls
                                                  
echo                 `-/+syyyyyso+/-`                 
echo             ./ymNmdhysoooosyhmNNdo:`             
echo          `/hNmy+-``         ``.:ohNNy:           
echo        .omNy:`        .:``       `.+dNd/`        
echo       +mNy-        ./ymMmm+-        `:dMh-       
echo     `yMd:     `-oohNMMMMMyyNh+-`      `+NN+      
echo    `dMy`     `sydMMMMMMMMy`dm+ddy+-`    -mMo     
echo   `hMy`     -somMMMMMMMMMo-NM:`/mMMmhs/` .mM+    
echo   oMm`      :sMMMMMMMMMMMNNMMy--hoyMMMMd: :MN.   
echo  `NM/       +NMMMMMMMMMMMmhhydNNNmNMMMMMN` hMy   
echo  :MN       .sMMMMMMMMMMMMh/    /yyhyyhyh:  /MN   
echo  +Mm      `:MMMMMMMMMMMMMMh-   `--.::--`   .MM`  
echo  +Mm   . +oNMMMMMMy+oMMMMMMo::` .          .MM`  
echo  -MM:/ohmMMMMMNdmy` `./shmNMmysss/:        /Mm   
echo   mMMNMMMMMMNm/yo`.ds:.  ``:smMmdh+        dMo   
echo   /MMMMMMMMmhd`.` .N+:/-`    `-/:.`       +MN`   
echo    sMMMMMMMmmm/oo+sysmy+/`               :NN:    
echo    `yMMMMdNhdymMMhys/.`                 /NN/     
echo      oNMN/:/-/oddd/                   .yMm:      
echo       -hMm/..` ```                  .omNs`       
echo         :hNms-`                  .:yNNs-         
echo           -omNdy+-.```    ```.:ohmNh+.           
echo              -+ydNNmdhhhhhhdmNNhs/.              
echo                  `.:/+++++/:-.                   
ping localhost -n .5 >nul
cls                                                  

goto :start01

====================================================================================

====================================================================================
@echo off

:start

Title "SAGE TECH TOOL v1.0.8B"

color 7

@ECHO OFF
echo ===============================================================================
@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725CMM
IF %RESULT%==7.2.0.4 GOTO :724FMM
IF %RESULT%==7.2.0.0 GOTO :720NMM
IF %RESULT%==7.0.0.0 GOTO :700DMM

:725CMM

echo ::MAIN MENU:: INSTALLED QUICKTOUCH VERSION: 7.2.5C              SSTv1.0.8B

GOTO :MAINMENU

:724FMM

echo ::MAIN MENU:: INSTALLED QUICKTOUCH VERSION: 7.2.4F              SSTv1.0.8B

GOTO :MAINMENU

:720NMM

echo ::MAIN MENU:: INSTALLED QUICKTOUCH VERSION: 7.2.0N              SSTv1.0.8B

GOTO :MAINMENU

:700DMM

echo ::MAIN MENU:: INSTALLED QUICKTOUCH VERSION: 7.0.0D              SSTv1.0.8B

GOTO :MAINMENU
) 
:MAINMENU
@echo off
IF EXIST "C:\Program Files\QuickTouch\Data\system3.sys" ( 
ECHO 		   INSTALLED MOTOR VERSION: FALL 2021   
) ELSE (
ECHO 		   INSTALLED MOTOR VERSION: DEC 2020 or earlier 
)

echo ===============================================================================
color F
echo 1. QUICKTOUCH                    :    ####      ###      ######    ######  : 
echo 2. DATABASE UTILITIES            :  ####       #####   ##     ##   ###     :
echo 3. QUICKTOUCH UTILITIES          :   ######   ### ###  ##   #####  #####   :
echo 4. WINDOWS UTILITIES             :      ###  ######### ##     ##   ###     :
echo 5. NEXGEN                        :   ####   ###     ###  ######    ######  :
echo 6. CARFAX                                      %date%
echo 7. RDP WRAPPER                                      
echo 8. FOLDER DIRECTORIES                                            
echo 9. MOTOR UPGRADE (FALL 2021)
echo 10. QUICKTOUCH ACTIVE
echo =============================
echo 11. ADDITIONAL TOOLS
echo =======================================================
echo 12. CLOSE/OPEN QUICKTOUCH
echo 13. CLOSE
@REM echo. 00001 /h
@REM echo. 00002 /h
set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%
echo =======================================================



====================================================================================
:Item_1

cls

cmd.exe /c start "sagepointofsale6" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\sagepointofsale6.exe"
wmic process where name="sagepointofsale6.exe" CALL setpriority "Realtime"

cls

GOTO :Start



====================================================================================



====================================================================================
:Item_2


echo off

:startDU

cls

Title "DATABASE UTILITIES"

color 7

cls
@echo off
    setlocal enableextensions disabledelayedexpansion

    set "file=C:\PROGRA~1\QuickTouch\Data\invoice.dat"

    for %%z in ("%file%") do for /f "tokens=1,2" %%a in ('
        robocopy "%%~dpz." "%%~dpz." "%%~nxz" /l /nocopy /is /njh /njs /ndl /nc
    ') do if "%%~dz"=="%%~db" (
echo=======================================================================
echo  : DATABASE UTILITIES:               INVOICE = [%%a]
echo=======================================================================
    )
echo   [PROCESSES]
echo 1. SAGE UTILITY             :    ####      ###      ######    ######  : 
echo 2. RECOVER INVOICE          :  ####       #####   ##     ##   ###     :
echo 3. DATABASE RECOVERY (DAT)  :   ######   ### ###  ##   #####  #####   :
echo 4. DATABASE RECOVERY (SYS)  :      ###  ######### ##     ##   ###     :
echo 5. REINDEX DATA             :   ####   ###     ###  ######    ######  :
echo 6. ARCHIVE                                 
echo 7. DATABASE COPY
echo 8. CLEAR4LIVE
echo.
echo   [DATABASES]
echo 9.  OPEN .DAT DATABASE
echo 10. OPEN .SYS DATABASE
echo 11. OPEN SHARED FILE
echo ==========================
echo 12. DATA FILE LOCATION
echo ==========================
echo 0. MAIN MENU
echo 14. CLOSE                                 
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%DU


====================================================================================
====================================================================================
====================================================================================



:Item_1DU

cmd.exe /c start "SageUtility" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\SageUtility.exe"
wmic process where name="SageUtility.exe" CALL setpriority "Realtime"
cls
GOTO :StartDU


====================================================================================
====================================================================================
====================================================================================



:Item_2DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls


color C
COPY "C:\Program Files\QuickTouch\Data\Invoice.dat" "C:\Program Files\QuickTouch"
IF EXIST Invoice.dat (
    del invoice.dat
) 
COPY "C:\Program Files\QuickTouch\Data\Recover.dat" "C:\Program Files\QuickTouch"
IF EXIST Recover.dat (
    del Recover.dat
) 

rename "C:\Program Files\QuickTouch\Recover.dat" "Recover-copy.dat"
IF EXIST recover-copy.dat (
    del recover-copy.dat
)

COPY "C:\Program Files\QuickTouch\Recover-copy.dat" "C:\Program Files\QuickTouch\data"
IF EXIST recover-copy.dat (
    del recover-copy.dat
)

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\recover-copy.dat"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

msg * !! Invoice.dat copy completed : Recovery-copy.dat created !!
msg * !! Perform INVOICE RECOVERY before continuing with SAGETechTool : Close MSACCESS when completed  !!! 

cls

@ECHO OFF

:choice
set /P c=Recovery Complete Successfully?[Y/N]?
if /I "%c%" EQU "Y" goto :somewhere
if /I "%c%" EQU "N" goto :somewhere_else
goto :choice

:somewhere
DEL "C:\Program Files\QuickTouch\data\invoice.dat"
DEL "C:\Program Files\QuickTouch\recover-copy.dat"

rename "C:\Program Files\QuickTouch\Data\recover-copy.dat" "invoice.dat"
GOTO :RECOVERCOMPLETE

:somewhere_else
DEL "C:\Program Files\QuickTouch\data\invoice.dat"
DEL "C:\Program Files\QuickTouch\data\recover-copy.dat"

COPY "C:\Program Files\QuickTouch\Invoice.dat" "C:\Program Files\QuickTouch\data"
IF EXIST invoice.dat (
    del invoice.dat
) 


@ECHO OFF

:choice
set /P c=Would You Like to Restart Recovery Process?[Y/N]?
if /I "%c%" EQU "Y" goto :somewhere
if /I "%c%" EQU "N" goto :somewhere_else
goto :choice

:somewhere
cls

GOTO :Item_2DU

:somewhere_else
cls

GOTO :Start


:RECOVERCOMPLETE


color C
cls
@echo off
echo.
echo.
echo              ===========================================
echo              +    ####      ###      ######    ######  +
echo              +  ####       #####   ##     ##   ###     +
echo              +   ######   ### ###  ##   #####  #####   +
echo              +      ###  ######### ##     ##   ###     +  
echo              +   ####   ###     ###  ######    ######  +   
echo              ===========================================
echo                    [     RECOVERY COMPLETE     ] 
echo.
echo                    [  IF THERE ARE ANY ISSUES  ]     
echo.
echo [  A BACKUP OF THE ORIGINAL INVOICE.DAT IS IN THE QUICKTOUCH FOLDER  ]
echo.
echo.
echo.


timeout /t 5
cls

GOTO :StartDU


====================================================================================
====================================================================================
====================================================================================



:Item_3DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls


cls
echo off
cls
cd /D C:\Program Files\QuickTouch\Data
setlocal enabledelayedexpansion
set count=0
:: Read in files
for %%x in (*.dat*) do (
  set /a count=count+1
  set choice[!count!]=%%x
)
echo.
for /l %%x in (1,1,!count!) do (
   echo %%x] !choice[%%x]!
)
echo.
:: Retrieve User input
echo ===============================================================================
echo ===============================================================================
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +                   
echo ===============================================================================
echo ===============================================================================
set /P selected="Please choose Database by number: "
:: Print list of files

for %%i in (%selected%) do (
   COPY "C:\Program Files\QuickTouch\Data\!choice[%%i]!" "C:\Program Files\QuickTouch"

RENAME "C:\Program Files\QuickTouch\!choice[%%i]!" "!choice[%%i]!BACKUP"     

COPY "C:\Program Files\QuickTouch\Data\Recover.dat" "C:\Program Files\QuickTouch"


RENAME "C:\Program Files\QuickTouch\Recover.dat" "Recover-copy.dat"


COPY "C:\Program Files\QuickTouch\Recover-copy.dat" "C:\Program Files\QuickTouch\data"


DEL "C:\Program Files\QuickTouch\recover-copy.dat"


cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\recover-copy.dat"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

echo "!choice[%%i]!"

msg * !! DATABSE copy completed : Recovery-copy.dat created !!
msg * !! Perform RECOVERY before continuing with SAGETechTool : Close MSACCESS when completed  !! 

cls

@ECHO OFF
cls
echo.
echo.
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +                   
echo.
echo.
echo                 [CONTINUE WHEN RECOVERY PROCESS IS COMPLETE]
echo.
echo.
pause


DEL "C:\Program Files\QuickTouch\"!choice[%%i]!""
DEL "C:\Program Files\QuickTouch\Data\"!choice[%%i]!""
rename "C:\Program Files\QuickTouch\Data\recover-copy.dat" "!choice[%%i]!"
cls

DEL "C:\Program Files\QuickTouch\recover-copy.dat"
cls
echo.
echo.
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +                   
echo.
echo.
echo 		     AN ORIGINAL COPY OF THE FILE CAN BE FOUND IN
echo                       "C:\Program Files\QuickTouch"
echo 			        CONTINUE TO MAIN MENU  
echo .
echo .
)
timeout /t  8
cls
GOTO :startDU


====================================================================================
====================================================================================
====================================================================================


:Item_4DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls
echo off
cls
cd /D C:\Program Files\QuickTouch\Data
setlocal enabledelayedexpansion
set count=0
:: Read in files
for %%x in (*.sys*) do (
  set /a count=count+1
  set choice[!count!]=%%x
)
echo.
for /l %%x in (1,1,!count!) do (
   echo %%x] !choice[%%x]!
)
echo.
:: Retrieve User input
echo.
echo.
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +                   
echo.
echo.
set /P selected="Please choose files by number: "
:: Print list of files

for %%i in (%selected%) do (
   COPY "C:\Program Files\QuickTouch\Data\!choice[%%i]!" "C:\Program Files\QuickTouch"

RENAME "C:\Program Files\QuickTouch\!choice[%%i]!" "!choice[%%i]!BACKUP"     

COPY "C:\Program Files\QuickTouch\Data\Recover.dat" "C:\Program Files\QuickTouch"


RENAME "C:\Program Files\QuickTouch\Recover.dat" "Recover-copy.dat"


COPY "C:\Program Files\QuickTouch\Recover-copy.dat" "C:\Program Files\QuickTouch\data"


DEL "C:\Program Files\QuickTouch\recover-copy.dat"


cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\recover-copy.dat"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

echo "!choice[%%i]!"

msg * !! DATABSE copy completed : Recovery-copy.dat created !!
msg * !! Perform RECOVERY before continuing with SAGETechTool : Close MSACCESS when completed  !! 

cls

@ECHO OFF
cls
echo.
echo.
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +                   
echo.
echo.
echo                   CONTINUE WHEN RECOVERY PROCESS IS COMPLETE
echo.
echo.
pause


DEL "C:\Program Files\QuickTouch\"!choice[%%i]!""
DEL "C:\Program Files\QuickTouch\Data\"!choice[%%i]!""
rename "C:\Program Files\QuickTouch\Data\recover-copy.dat" "!choice[%%i]!"
cls

DEL "C:\Program Files\QuickTouch\recover-copy.dat"
cls
echo.
echo.
echo                  +    ####      ###      ######    ######  + 
echo                  +  ####       #####   ##     ##   ###     +     
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     + 
echo                  +   ####   ###     ###  ######    ######  +                   
echo.
echo.
echo                  A ORIGINAL COPY OF THE FILE CAN BE FOUND IN 
echo                        "C:\Program Files\QuickTouch"
echo                             CONTINUE TO MAIN MENU 
echo.
echo.
)
timeout /t  8
cls
GOTO :startDU




====================================================================================
====================================================================================
====================================================================================




:Item_5DU

IF EXIST "C:\Program Files\QuickTouch\Data - copy" (
    rmdir "C:\Program Files\QuickTouch\Data - copy" /s /q
)


md "C:\Program Files\QuickTouch\Data - copy"



xCOPY /e /v "C:\Program Files\QuickTouch\Data" "C:\Program Files\QuickTouch\Data - copy"

cls

ren "C:\Program Files\QuickTouch\Data - copy" "PreReindex_Data"

cls

cmd.exe /c start "POSRebuild" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\POSRebuild.exe"
wmic process where name="POSRebuild.exe" CALL setpriority "Realtime"

cls

msg * !!! Click REINDEX ONLY before proceeding !!!

msg * !!! TAKE NOTE OF ANY ERRORS !!!

cls

@ECHO OFF

:choice
set /P c=Reindex Complete Without Errors?[Y/N]?
if /I "%c%" EQU "Y" goto :somewhere
if /I "%c%" EQU "N" goto :somewhere_else
GOTO :choice


:somewhere

cls


echo                  +    ####      ###      ######    ######  +  
echo                  +  ####       #####   ##     ##   ###     +
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     + 
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo                           !  REINDEX COMPLETE  ! 
echo.
echo                              RETURNING TO MENU 
echo.
echo.
timeout /t 7
cls
GOTO :startDU


:somewhere_else


@echo off

md "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  


xcopy "C:\Program Files\QuickTouch\PreReindex_Data\*.dat" "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  


COPY "C:\Program Files\QuickTouch\PreReindex_Data\GeneralSetup.sys" "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  

:COMPRESS
echo on

for /f "tokens=3,2,4 delims=/- " %%x in ("%date%") do set d=%%y%%x%%z

set data=%d%

"C:\Program Files\7-Zip\7z.exe" a -tzip "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%.zip" "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%"


rmdir /s /q "C:\SageUtilities\DataPreRebuild_%date:~-10,2%%date:~-7,2%%date:~-4,4%_%time:~0,2%%time:~3,2%"

@echo off
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo              "DataPreRebuild_(DATE)_(TIME).zip" HAS BEEN CREATED 
echo                         LOCATED IN "C:\SageUtilities" 
echo.
echo                           !!! CONTACT T2 SUPPORT !!!           
echo.
echo.
echo.
 

timeout /t 200
@echo off
cls
color C
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo                         SAGETECHTOOL WILL NOW CLOSE
echo.
echo.
timeout /t 7

cls

echo GG y'all
echo PEACE OOT

timeout /t .5
cls


EXIT




====================================================================================
====================================================================================
====================================================================================



:Item_6DU

:ARCHIVEPASS

@echo off

cls
setlocal

set /P "=sage1234" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls
color 07

IF "%Password%"=="S@ge123" GOTO :ARCHIVEACCESS

color C

Echo INCORRECT PASSWORD 

goto :ARCHIVEPASS

:ARCHIVEACCESS


IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC10.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC10.dat" "invoiceSEC11.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC9.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC9.dat" "invoiceSEC10.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC8.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC8.dat" "invoiceSEC9.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC7.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC7.dat" "invoiceSEC8.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC6.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC6.dat" "invoiceSEC7.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC5.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC5.dat" "invoiceSEC6.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC4.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC4.dat" "invoiceSEC5.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC3.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC3.dat" "invoiceSEC4.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC2.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC2.dat" "invoiceSEC3.dat"
)

IF EXIST C:\Program Files\QuickTouch\Data\invoiceSEC.dat (
    ren "C:\Program Files\QuickTouch\Data\invoiceSEC.dat" "invoiceSEC2.dat"
)


cmd.exe /c start "Archive" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\Archive.exe"
wmic process where name="Archive.exe" CALL setpriority "Realtime"

cls

color C
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN
echo  CONTINUE WHEN ARCHIVE HAS BEGUN

timeout /t 10

cls

color 2
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
echo  ================ARCHIVE IN PROGRESS=================
timeout /t 3
cls

echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo = "Archive.exe" WILL PROMPT WHEN QUICKTOUCH IS READY FOR USE OR WILL BE DONE  =
echo.
echo.
echo                         SAGETECHTOOL WILL NOW CLOSE
echo.
echo.
echo.

timeout /t 10

cls

echo  PEACE OUT GIRL SCOUT!

timeout /t .5

cls

EXIT


====================================================================================
====================================================================================
====================================================================================



:Item_7DU


@echo off

md "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"
cls

COPY "C:\Program Files\QuickTouch\Data\shared" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"

xcopy "C:\Program Files\QuickTouch\Data\*.dat" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"
cls

xcopy "C:\Program Files\QuickTouch\Data\*.html" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"
cls

xcopy "C:\Program Files\QuickTouch\Data\*.jpg" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"
cls


COPY "C:\Program Files\QuickTouch\Data\GeneralSetup.sys" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"
cls



@echo off

cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  

IF EXIST "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%.zip" (
DEL "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%.zip"
) ELSE (
GOTO :COMPRESS
)



:COMPRESS
echo off

for /f "tokens=3,2,4 delims=/- " %%x in ("%date%") do set d=%%y%%x%%z

set data=%d%

"C:\Program Files\7-Zip\7z.exe" a -tzip "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%.zip" "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%"

DEL "C:\SageUtilities\DataBaseCopy_%date:~-10,2%%date:~-7,2%%date:~-4,4%" /Y

cls
@echo off

echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo.
echo                   "DataBaseCopy_(DATE).zip" HAS BEEN CREATED 
echo                         LOCATED IN "C:\SageUtilities" 
echo.
echo.



timeout /t 20
cls

GOTO :startDU



====================================================================================
====================================================================================
====================================================================================
:Item_8DU

cls

cmd.exe /c start "Archive" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\ClearForLive2.exe"
wmic process where name="Archive.exe" CALL setpriority "Realtime"

cls

GOTO :startDU


====================================================================================
====================================================================================
====================================================================================


:Item_9DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls

cls
echo off
cls
cd /D C:\Program Files\QuickTouch\Data
setlocal enabledelayedexpansion
set count=0
:: Read in files
for %%x in (*.dat*) do (
  set /a count=count+1
  set choice[!count!]=%%x
)
echo.
for /l %%x in (1,1,!count!) do (
   echo %%x] !choice[%%x]!
)
echo.
:: Retrieve User input

set /P selected="Please choose Database by number: "
:: Print list of files

for %%i in (%selected%) do ( 

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\!choice[%%i]!"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

)

CLS

GOTO :startDU




====================================================================================
====================================================================================
====================================================================================

:Item_10DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls

cls
echo off
cls
cd /D C:\Program Files\QuickTouch\Data
setlocal enabledelayedexpansion
set count=0
:: Read in files
for %%x in (*.sys*) do (
  set /a count=count+1
  set choice[!count!]=%%x
)
echo.
for /l %%x in (1,1,!count!) do (
   echo %%x] !choice[%%x]!
)
echo.
:: Retrieve User input

set /P selected="Please choose Database by number: "
:: Print list of files

for %%i in (%selected%) do ( 

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\!choice[%%i]!"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

)

CLS

GOTO :startDU




====================================================================================
====================================================================================
====================================================================================

:Item_11DU

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls

cls
echo off
cls
cd /D C:\Program Files\QuickTouch\Data\Shared
setlocal enabledelayedexpansion
set count=0
:: Read in files
for %%x in (*.csi*) do (
  set /a count=count+1
  set choice[!count!]=%%x
)
echo.
for /l %%x in (1,1,!count!) do (
   echo %%x] !choice[%%x]!
)
echo.
:: Retrieve User input

set /P selected="Please choose Database by number: "
:: Print list of files

for %%i in (%selected%) do ( 

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\Shared\!choice[%%i]!"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

)

CLS

GOTO :startDU

====================================================================================
====================================================================================
====================================================================================


:Item_12DU

cls

explorer.exe "C:\Program Files\QuickTouch\Data"

cls

GOTO :startDU

====================================================================================
====================================================================================
====================================================================================


:Item_0DU

cls

GOTO :start


====================================================================================
====================================================================================
====================================================================================







:Item_3

echo off

:startQU

cls

Title "QUICKTOUCH UTILITIES"

cls

:startQU

color F
@ECHO OFF

FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725CMM
IF %RESULT%==7.2.0.4 GOTO :724FMM
IF %RESULT%==7.2.0.0 GOTO :720NMM
IF %RESULT%==7.0.0.0 GOTO :700DMM

:725CMM
echo ===========================================================================
ECHO                [  INSTALLED QUICKTOUCH VERSION: 7.2.5C  ]

GOTO :QUMENU

:724FMM
echo ===========================================================================
ECHO                [  INSTALLED QUICKTOUCH VERSION: 7.2.4F  ]       

GOTO :QUMENU

:720NMM
echo ===========================================================================
ECHO                [  INSTALLED QUICKTOUCH VERSION: 7.2.0N  ]          

GOTO :QUMENU

:700DMM
echo ===========================================================================
ECHO                [  INSTALLED QUICKTOUCH VERSION: 7.0.0D  ]        

GOTO :QUMENU

)
:QUMENU
echo ===========================================================================
echo  : QUICKTOUCH UTILITIES:
echo.
echo 1. BAY INFORMATION              :    ####      ###      ######    ######  : 
echo 2. ALL POS CONTROLS/ALL POS64bit:  ####       #####   ##     ##   ###     :
echo 3. TASK KILL BACKGROUND         :   ######   ### ###  ##   #####  #####   :
echo 4. CHECKLIST_RTE9               :      ###  ######### ##     ##   ###     :
echo 5. DUPLICATECHECKPOINTSFIX      :   ####   ###     ###  ######    ######  :
echo 6. REGISTER DLLs
echo 7. KEYSTOLUBE
echo 8. SETUP64.exe
echo 9. EXPIRATION DATES 
echo 10. QT - AFF/PRO SETUP
echo ==========================                                  
echo 11. QUICKTOUCH UPGRADES (700D, 720N, 724F, 725C)
echo ==========================
echo 0. MAIN MENU
echo 13. CLOSE                                
echo ===========================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%QU


====================================================================================
====================================================================================
====================================================================================



:Item_1QU

cmd.exe /c start "BayInformation" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\Data\BayInformation.exe"
wmic process where name="BayInformation.exe" CALL setpriority "Realtime"
cls
GOTO :StartQU


====================================================================================
====================================================================================
====================================================================================



:Item_2QU

cls

:EXPOSCON
@echo off

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\All POS Controls\setup.exe" GOTO :EXALLPOS

echo "Extracting ALL POS CONTROLS"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE\AllPOSControls.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs%

 
cls

:EXALLPOS
@echo off

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\All POS64bit\AllPOsControls.exe" GOTO :POSCON

echo "Extracting ALL POS 64BIT"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE\AllPOS64bit.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs%


cls

:POSCON
start /w "" "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\All POS Controls\setup.exe"

:ALLPOS
start /w "" "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\All POS64bit\AllPOsControls.exe

cls

echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo 			        REINSTALLATION COMPLETE  
echo.
echo.



timeout /t 5
cls

GOTO :StartQU



====================================================================================
====================================================================================
====================================================================================



:Item_3QU

taskkill /F /IM sagepointofsale6.exe

taskkill /F /IM TransmitServer.exe

taskkill /F /IM CarFaxTransmit.exe

echo ==Quicktouch Instances Closed==
echo ==Transmit Server Instances Closed==
echo ==CarFax Transmit Instances Closed==

cls

GOTO :StartQU



====================================================================================
====================================================================================
====================================================================================


:Item_4QU

cmd.exe /c start "CheckList_RTE9" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\Data\CheckList_RTE9.exe"
wmic process where name="CheckList_RTE9.exe" CALL setpriority "Realtime"
cls
GOTO :StartQU


====================================================================================
====================================================================================
====================================================================================


:Item_5QU

cmd.exe /c start "DuplicateCheckPointsFix" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\Data\DuplicateCheckPointsFix.exe"
wmic process where name="DuplicateCheckPointsFix.exe" CALL setpriority "Realtime"

cls

GOTO :startQU

====================================================================================
====================================================================================
====================================================================================


:Item_6QU

@echo off

cls

cd C:\Program Files\Quicktouch\Data
regsvr32 /s /u CFD.dll
regsvr32 /s /u CFIntegration.dll
regsvr32 /s /u DataServers.dll
regsvr32 /s /u EnDecryption.dll
regsvr32 /s /u InvoiceFormats.dll 
regsvr32 /s /u SageCRReports.dll
regsvr32 /s /u SageReportServer.dll 
regsvr32 /s /u SageTimer.dll
regsvr32 /s /u sticker.dll 

ECHO All dll files have been unregistered

regsvr32 /s CFD.dll 
regsvr32 /s CFIntegration.dll 
regsvr32 /s DataServers.dll 
regsvr32 /s EnDecryption.dll 
regsvr32 /s InvoiceFormats.dll 
regsvr32 /s SageCRReports.dll 
regsvr32 /s SageReportServer.dll 
regsvr32 /s SageTimer.dll  
regsvr32 /s sticker.dll

ECHO All dll files are now registered

echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo                         "DLL" REGISTRACTION COMPLETE 
echo.

timeout /t 5
cls

GOTO :StartQU


====================================================================================
====================================================================================
====================================================================================


:Item_7QU

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Databases\KEYSTOLUBE\KeyToLube.sys" "C:\Program Files\QuickTouch\data"
IF EXIST KeyToLube.sys (
    del KeyToLube.sys
) 
cls
GOTO startQU


====================================================================================
====================================================================================
====================================================================================

:Item_8QU

"C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\setup64.exe"

cls

GOTO :startQU


====================================================================================
====================================================================================
====================================================================================

:Item_9QU

"C:\Program Files\QuickTouch\sagepointofsale6.exe" secure

cls

GOTO :startQU


====================================================================================
====================================================================================
====================================================================================



:Item_10QU

@echo off

cls

set /P "=sage1234" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls
color 07

IF "%Password%"=="S@ge123" GOTO :QTAP

color C

Echo INCORRECT PASSWORD 

goto :Item_3

:QTAP

cls

@echo off

color F
echo =======================================================================
echo  : QUICKTOUCH - AFF/PRO SETUP:   
echo =======================================================================
echo   [PROCESSES]
echo.                            :    ####      ###      ######    ######  : 
echo 1. INSTALL                  :  ####       #####   ##     ##   ###     :
echo.                            :   ######   ### ###  ##   #####  #####   :
echo 2. UNINSTALL                :      ###  ######### ##     ##   ###     :
echo.                            :   ####   ###     ###  ######    ######  :
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%QTAP

=================================
=================================
=================================

:Item_1QTAP
@echo off

cls

DEL "C:\Users\Public\Desktop\QuickTouch.lnk"

xCOPY "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\Scripts\Aff_Pri" "C:\Program Files\QuickTouch" /y

COPY "C:\Program Files\QuickTouch\Quicktouch.lnk" "C:\Users\Public\Desktop"

cls

GOTO :startQU

==============================================
==============================================
==============================================

:Item_2QTAP
@echo off

cls

DEL "C:\Users\Public\Desktop\QuickTouch.lnk"

cls

COPY "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\QTBASE\QuickTouch.lnk" "C:\Users\Public\Desktop"

cls

GOTO :startQU


====================================================================================
====================================================================================
====================================================================================


:Item_11QU

cls


@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725CUP
IF %RESULT%==7.2.0.4 GOTO :724FUP
IF %RESULT%==7.2.0.0 GOTO :720NUP
IF %RESULT%==7.0.0.0 GOTO :700DUP

:725CUP
echo ==============================================================
echo  :CURRENT QUICKTOUCH VERSION: 7.2.5C           

GOTO :QTUPGRADES

:724FUP
echo ==============================================================
echo  :CURRENT QUICKTOUCH VERSION: 7.2.4F           

GOTO :QTUPGRADES

:720NUP
echo ==============================================================
echo  :CURRENT QUICKTOUCH VERSION: 7.2.0N             

GOTO :QTUPGRADES

:700DUP
echo ==============================================================
echo  :CURRENT QUICKTOUCH VERSION: 7.0.0D            

GOTO :QTUPGRADES

)
:QTUPGRADES
echo ==============================================================
echo    [UPGRADES]
echo 1. 7.0.0D          :    ####      ###      ######    ######  :
echo 2. 7.2.0N          :  ####       #####   ##     ##   ###     :
echo 3. 7.2.4F          :   ######   ### ###  ##   #####  #####   :
echo 4. 7.2.5C          :      ###  ######### ##     ##   ###     :
echo                    :   ####   ###     ###  ######    ######  :
echo===============
echo 5. QU MENU
echo 6. MAIN MENU
echo ===============================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%qtug


==========================================

:Item_1qtug

cls
COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Databases\700D\recover.dat" "C:\Program Files\QuickTouch\Data"

IF EXIST Recover.dat (
    del Recover.dat
)

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\700D\Sage\Upgrade.exe" (
GOTO :700DUP
) ELSE (
GOTO :700DEXTRACT
)

:700DEXTRACT
echo "Extracting Quicktouch 7.0.0D"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTBASE\700D.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs%


cls



:700DUP

DEL "C:\Program Files\QuickTouch\sagepointofsale6.exe" "sagepointofsale6_BKP.exe"

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\700D\Sage\sagepointofsale6.exe" "C:\Program Files\QuickTouch"
cls





cmd.exe /c start "Upgrade" /Realtime /Affinity 0x1 "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTBASE\700D\Sage\Upgrade.exe"
wmic process where name="Upgrade.exe" CALL setpriority "Realtime"
cls
echo                  +    ####      ###      ######    ######  +
echo                  +  ####       #####   ##     ##   ###     +
echo                  +   ######   ### ###  ##   #####  #####   +
echo                  +      ###  ######### ##     ##   ###     +
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo			       INSTALL QUICKTOUCH 700D
echo.

pause

cls
@echo off
color 2
echo                          +    ####      ###      ######    ######  + 
echo    INSTALL COMPLETE      +  ####       #####   ##     ##   ###     +
echo                          +   ######   ### ###  ##   #####  #####   +
echo    INSTALLED VERSION:    +      ###  ######### ##     ##   ###     +
echo                          +   ####   ###     ###  ######    ######  +
@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725Ccom
IF %RESULT%==7.2.0.4 GOTO :724Fcom
IF %RESULT%==7.2.0.0 GOTO :720Ncom
IF %RESULT%==7.0.0.0 GOTO :700Dcom

:725Ccom

ECHO         7.2.5C             

goto :UPCOMPLETED

:724Fcom

ECHO         7.2.4F             

goto :UPCOMPLETED

:720Ncom

ECHO         7.2.0N             

goto :UPCOMPLETED

:700Dcom

ECHO         7.0.0D             

goto :UPCOMPLETED
)
:UPCOMPLETED
echo.
echo.  LOADING TO MAIN MENU
echo.
echo.
timeout /t 5
cls

GOTO :Start







==========================================

:Item_2qtug

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Databases\720N\recover.dat" "C:\Program Files\QuickTouch\Data"

IF EXIST Recover.dat (
    del Recover.dat
)

cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\720N\upgrade.exe" (
GOTO :720NUP
) ELSE (
GOTO :720NEXTRACT
)

:720NEXTRACT
echo "Extracting Quicktouch 7.2.0N"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions\720N.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs% 
cls

:720NUP

DEL "C:\Program Files\QuickTouch\sagepointofsale6.exe"

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\720N\Sage\sagepointofsale6.exe" "C:\Program Files\QuickTouch"
cls





cmd.exe /c start "Upgrade" /Realtime /Affinity 0x1 "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\720N\upgrade.exe"
wmic process where name="upgrade.exe" CALL setpriority "Realtime"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo			       INSTALL QUICKTOUCH 720N
echo.

pause

cls
@echo off
color 2
echo                          +    ####      ###      ######    ######  + 
echo    INSTALL COMPLETE      +  ####       #####   ##     ##   ###     +
echo                          +   ######   ### ###  ##   #####  #####   +
echo    INSTALLED VERSION:    +      ###  ######### ##     ##   ###     +
echo                          +   ####   ###     ###  ######    ######  +
@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725Ccom
IF %RESULT%==7.2.0.4 GOTO :724Fcom
IF %RESULT%==7.2.0.0 GOTO :720Ncom
IF %RESULT%==7.0.0.0 GOTO :700Dcom

:725Ccom

ECHO         7.2.5C             

goto :UPCOMPLETED

:724Fcom

ECHO         7.2.4F             

goto :UPCOMPLETED

:720Ncom

ECHO         7.2.0N             

goto :UPCOMPLETED

:700Dcom

ECHO         7.0.0D             

goto :UPCOMPLETED
)
:UPCOMPLETED
echo.
echo.  LOADING TO MAIN MENU
echo.
echo.
timeout /t 5
cls

GOTO :Start







==========================================

:Item_3qtug
COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Databases\724F\recover.dat" "C:\Program Files\QuickTouch\Data"

IF EXIST Recover.dat (
    del Recover.dat
)

cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\724F\upgrade.exe" (
GOTO :724FUP
) ELSE (
GOTO :724FEXTRACT
)

:724FEXTRACT

echo "Extracting Quicktouch 7.2.4F"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions\724F.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs%
cls

:724FUP

DEL "C:\Program Files\QuickTouch\sagepointofsale6.exe" 

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\724F\Support\QuickTouch\sagepointofsale6.exe" "C:\Program Files\QuickTouch"
cls




cmd.exe /c start "Upgrade" /Realtime /Affinity 0x1 "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\724F\upgrade.exe"
wmic process where name="upgrade.exe" CALL setpriority "Realtime"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo			       INSTALL QUICKTOUCH 724F
echo.


pause

cls
@echo off
color 2
echo                          +    ####      ###      ######    ######  + 
echo    INSTALL COMPLETE      +  ####       #####   ##     ##   ###     +
echo                          +   ######   ### ###  ##   #####  #####   +
echo    INSTALLED VERSION:    +      ###  ######### ##     ##   ###     +
echo                          +   ####   ###     ###  ######    ######  +
@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725Ccom
IF %RESULT%==7.2.0.4 GOTO :724Fcom
IF %RESULT%==7.2.0.0 GOTO :720Ncom
IF %RESULT%==7.0.0.0 GOTO :700Dcom

:725Ccom

ECHO         7.2.5C             

goto :UPCOMPLETED

:724Fcom

ECHO         7.2.4F             

goto :UPCOMPLETED

:720Ncom

ECHO         7.2.0N             

goto :UPCOMPLETED

:700Dcom

ECHO         7.0.0D             

goto :UPCOMPLETED
)
:UPCOMPLETED
echo.
echo.  LOADING TO MAIN MENU
echo.
echo.
timeout /t 5
cls

GOTO :Start






==========================================

:Item_4qtug
COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Databases\725C\recover.dat" "C:\Program Files\QuickTouch\Data"

IF EXIST Recover.dat (
    del Recover.dat
)

cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\725_Upgrade\upgrade.exe" (
GOTO :725CUP
) ELSE (
GOTO :725CEXTRACT
)


:725CEXTRACT
echo "Extracting Quicktouch 7.2.5C"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\QTVersions\725C.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs%

 
cls

:725CUP
DEL "C:\Program Files\QuickTouch\sagepointofsale6.exe" 

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\725_Upgrade\Support\QuickTouch\sagepointofsale6.exe" "C:\Program Files\QuickTouch"
cls




cmd.exe /c start "Upgrade" /Realtime /Affinity 0x1 "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTVersions\725_Upgrade\upgrade.exe"
wmic process where name="upgrade.exe" CALL setpriority "Realtime"
cls
echo                  +    ####      ###      ######    ######  +                   
echo                  +  ####       #####   ##     ##   ###     +                   
echo                  +   ######   ### ###  ##   #####  #####   +                   
echo                  +      ###  ######### ##     ##   ###     +                   
echo                  +   ####   ###     ###  ######    ######  +  
echo.
echo			       INSTALL QUICKTOUCH 725C
echo.


pause

cls
@echo off
color 2
echo                          +    ####      ###      ######    ######  + 
echo    INSTALL COMPLETE      +  ####       #####   ##     ##   ###     +
echo                          +   ######   ### ###  ##   #####  #####   +
echo    INSTALLED VERSION:    +      ###  ######### ##     ##   ###     +
echo                          +   ####   ###     ###  ######    ######  +
@ECHO OFF
FOR /F "tokens=2 delims==" %%I IN (
  'wmic datafile where "name='C:\\Program Files\\Quicktouch\\sagepointofsale6.exe'" get version /format:list'
) DO SET "RESULT=%%I" (

IF %RESULT%==7.2.0.5 GOTO :725Ccom
IF %RESULT%==7.2.0.4 GOTO :724Fcom
IF %RESULT%==7.2.0.0 GOTO :720Ncom
IF %RESULT%==7.0.0.0 GOTO :700Dcom

:725Ccom

ECHO         7.2.5C             

goto :UPCOMPLETED

:724Fcom

ECHO         7.2.4F             

goto :UPCOMPLETED

:720Ncom

ECHO         7.2.0N             

goto :UPCOMPLETED

:700Dcom

ECHO         7.0.0D             

goto :UPCOMPLETED
)
:UPCOMPLETED
echo.
echo.  LOADING TO MAIN MENU
echo.
echo.
timeout /t 5
cls

GOTO :Start



:Item_5qtug

cls

GOTO :startQU

====================================================================================
====================================================================================
====================================================================================


:Item_6qtug

cls

GOTO :start

====================================================================================
====================================================================================
====================================================================================

:Item_0QU

cls

GOTO :start







====================================================================================
====================================================================================
====================================================================================

:Item_4

:startWU

@echo off

Title "WINDOWS UTILITIES"

cls

color F
echo =======================================================================
echo  :WINDOWS UTILITIES:
echo =======================================================================
echo   [PROCESSES]
echo 1. RESTART FILE EXPLORER    :    ####      ###      ######    ######  :
echo 2. PING LOGGER              :  ####       #####   ##     ##   ###     :
echo 3. SYSTEM SCAN              :   ######   ### ###  ##   #####  #####   :
echo 4. CLEAR OLD "Sage" FILES   :      ###  ######### ##     ##   ###     :
echo                             :   ####   ###     ###  ######    ######  :
echo   [TOOLS]
echo 5. WINDOWS CREDS. MANAGER
echo 6. SCHEDULED TASKS
echo 7. OS SERVICES
echo 8. CONTROL PANEL
echo 9. SHARING SETTINGS
echo.
echo   [INFORMATION]
echo 10. SYSTEM INFORMATION
echo ======================
echo 0. MAIN MENU
echo 12. CLOSE
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%WU

=======================================================================
=======================================================================
=======================================================================

:Item_1WU

cls

taskkill /f /im explorer.exe

cls

start explorer.exe

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_2WU

cls

@echo off

start "" "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\Ping Logger\PingTime.bat"

msg * WHEN COMPLETED LOG IS LOCATED IN "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\Ping Logger" 								CTRL + C TO TERMINATE BATCH JOB

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_3WU

cls

start "" sfc /scannow

cls

GOTO :startWU


=======================================================================
=======================================================================

:Item_4WU

@echo off

IF EXIST "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\SagePOSBU" (
    rmdir "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\SagePOSBU" /s /q
)



md "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\SagePOSBU"




XCOPY /s /e "C:\SagePOSBU\Backup_001" "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\SagePOSBU"



rmdir "C:\SagePOSBU" /s /q

DEL "C:\Program Files\QuickTouch\Data\*.bak" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak1" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak2" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak3" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak3" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak4" /S /Q

DEL "C:\Program Files\QuickTouch\Data\*.bak5" /S /Q

cls
echo                   SagePOSBU HAS BEEN CLEARED
echo.
echo              A SINGLE BACKUP INSTANCE IS LOCATED IN
echo C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\SagePOSBU
echo.
echo.
timeout /t 3


GOTO :startWU




=======================================================================
=======================================================================

:Item_5WU

cls

start control /name Microsoft.CredentialManager

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_6WU

cls

@echo off


start control schedtasks

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_7WU

cls

@echo off

start services.msc

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_8WU

cls

control

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_9WU

cls

control.exe /name Microsoft.NetworkAndSharingCenter /page Advanced

cls

GOTO :startWU

=======================================================================
=======================================================================

:Item_10WU

cls

@echo off

echo.
echo              +    ####      ###      ######    ######  +      
echo              +  ####       #####   ##     ##   ###     +  
echo              +   ######   ### ###  ##   #####  #####   +    
echo              +      ###  ######### ##     ##   ###     +       
echo              +   ####   ###     ###  ######    ######  + 
echo.
echo LOCAL SYSTEM INFORMATION
systeminfo | findstr /B /C:"OS Name" /C:"System Type" /C:"Total Physical Memory"
echo.
echo CPU:
wmic cpu get name
echo.
echo NIC SPEED
wmic nic where netEnabled=true get name, speed
echo.
echo DRIVE SIZE
wmic logicaldisk get Name,Size | find /i "C:"
echo ==================================================================
echo.

echo CONTINUE TO MENU
pause

GOTO :startWU

=======================================================================
=======================================================================

:Item_0WU

cls

GOTO :start

====================================================================================
====================================================================================
====================================================================================










:Item_00002

@echo off

cls
setlocal

set /P "=sage1234" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls
color 07

IF "%Password%"=="egas" GOTO :startDA

color C

Echo INCORRECT PASSWORD 

GOTO :start

echo off

:startDA

cls

Title "DATE ADJUSTMENTS"

cls

:startDA
                    

echo ===========================================================================
echo  :DATE ADJUSTMENTS:
echo  :SYSTEM DATE: %date%
echo ===========================================================================
echo 1. CHANGE DATE                  :    ####      ###      ######    ######  : 
echo 2. CHANGE DATE - OPEN QT        :  ####       #####   ##     ##   ###     :
echo 3. CHANGE DATE - OPEN DATA      :   ######   ### ###  ##   #####  #####   :
echo ===========================     :      ###  ######### ##     ##   ###     :
echo 4. MAIN MENU                    :   ####   ###     ###  ######    ######  :                              
echo ===========================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%DA


====================================================================================
====================================================================================
====================================================================================



:Item_1DA

cls

W32TM /unregister

cls

date

cls

GOTO :startDA



====================================================================================
====================================================================================
====================================================================================


:Item_2DA

cls

W32TM /unregister

cls

date

cls

cmd.exe /c start "sagepointofsale6" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\sagepointofsale6.exe"
wmic process where name="sagepointofsale6.exe" CALL setpriority "Realtime"

cls

GOTO :startDA


====================================================================================
====================================================================================
====================================================================================

:Item_3DA

cls

W32TM /register

cls

date

cls

explorer "C:\Program Files\QuickTouch\Data\"

GOTO :startDA

====================================================================================
====================================================================================
====================================================================================


:Item_4DA

cls

echo              +    ####      ###      ######    ######  +                    
echo              +  ####       #####   ##     ##   ###     +                    
echo              +   ######   ### ###  ##   #####  #####   +                    
echo              +      ###  ######### ##     ##   ###     +                    
echo              +   ####   ###     ###  ######    ######  +                    
echo.
echo			  [CURRENT DATE:  %date%  ]
echo.
echo.
:choice2
set /P c=IS THE CURRENT DATE CORRECT?[Y/N]?
if /I "%c%" EQU "Y" goto :somewhere
if /I "%c%" EQU "N" goto :somewhere_else
goto :choice

:somewhere

cls

GOTO :start


:somewhere_else

cls

date

cls

GOTO :start



====================================================================================
====================================================================================
====================================================================================



:Item_5

echo off

:startNG

cls

Title "NEXGEN"

cls

:startNG
                    

echo ===========================================================================
echo  :NEXGEN:
echo ===========================================================================
echo   [PROGRAMS]
echo 1. SOAP                         :    ####      ###      ######    ######  : 
echo 2. TRANSMIT SERVER              :  ####       #####   ##     ##   ###     :
echo 3. TRANSMIT UTILITY             :   ######   ### ###  ##   #####  #####   :
echo.                                :      ###  ######### ##     ##   ###     :
echo   [DATABASES]                   :   ####   ###     ###  ######    ######  :
echo 4. TRANSMIT.SYS
echo 5. TRANSMITSETTINGS.SYS
echo 6. COMMINFO
echo.
echo   [FILE DIRECTORY]
echo 7. SAGETMP
echo.
echo   [PROCESSES]
echo 8. TRANSMIT REMAKE
echo.
echo ==============
echo 0. MAIN MENU                               
echo ===========================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%NG


====================================================================================
====================================================================================
====================================================================================



:Item_1NG

cmd.exe /c start "soapsdk" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\Data\soapsdk.exe"
wmic process where name="soapsdk.exe" CALL setpriority "Realtime"
cls
GOTO StartNG

====================================================================================
====================================================================================
====================================================================================








:Item_2NG

cmd.exe /c start "TransmitServer" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\TransmitServer.exe"
wmic process where name="TransmitServer.exe" CALL setpriority "Realtime"

cls

GOTO :startNG

====================================================================================
====================================================================================
====================================================================================









:Item_3NG
@echo off

cls

set /P "=sage1234" < NUL > "Enter password"
findstr /A:1E /V "^$" "Enter password" NUL > CON
del "Enter password"
set /P "password="
cls
color 07

IF "%Password%"=="S@ge123" GOTO :TU

color C

Echo INCORRECT PASSWORD 

goto :Item_06

:TU

cmd.exe /c start "TransmitUtility" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\data\TransmitUtility.exe"
wmic process where name="TransmitUtility.exe" CALL setpriority "Realtime"

cls


GOTO :startNG


====================================================================================
====================================================================================
====================================================================================









:Item_4NG 

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\transmit.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startNG

====================================================================================
====================================================================================
====================================================================================










:Item_5NG 

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\transmitsettings.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startNG

====================================================================================
====================================================================================
====================================================================================









:Item_6NG 

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\comminfo.mdb"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startNG

====================================================================================
====================================================================================
====================================================================================




:Item_7NG

cls

explorer "C:\Windows\SageTMP\"

cls

GOTO :start



====================================================================================
====================================================================================
====================================================================================



:Item_8NG

cls

@ECHO OFF


:: CLEAR OUT PREVIOUS TRANSMISSIONS

@ECHO OFF

IF EXIST SchTasks "NexGen 8PM" (
	schtasks /delete /tn "NexGen 8PM" /f
)

IF EXIST SchTasks "NexGen 10PM" (
	schtasks /delete /tn "NexGen 10PM" /f
)

IF EXIST SchTasks "NexGen SU" (
	schtasks /delete /tn "NexGen SU" /f
)

IF EXIST SchTasks "NexGen" (
	schtasks /delete /tn "NexGen" /f
)

IF EXIST SchTasks "NexGen1" (
	schtasks /delete /tn "NexGen1" /f
)

IF EXIST SchTasks "NexGen 1" (
	schtasks /delete /tn "NexGen 1" /f
)

IF EXIST SchTasks "NexGen Transmit" (
	schtasks /delete /tn "NexGen Transmit" /f
)

cls


:: CREATE NG TASKS
:: - 8PM Task
:: - 10PM Task
:: - Start Up


ECHO Create Schedule Task
SchTasks /Create /SC DAILY /TN "NexGen 8PM" /RL HIGHEST /TR "C:\Program Files\QuickTouch\Data\TransmitServer.exe" /ST 20:00
SchTasks /Create /SC DAILY /TN "NexGen 10PM" /RL HIGHEST /TR "C:\Program Files\QuickTouch\Data\TransmitServer.exe" /ST 22:00
SCHTASKS /CREATE /SC ONLOGON /DELAY 0000:10 /TN "NexGen SU" /RL HIGHEST /TR "C:\Program Files\QuickTouch\Data\TransmitServer.exe"

cls

msg * 8PM, 10PM and StartUp Tasks Created

cls

echo.
echo.
echo.
echo              +    ####      ###      ######    ######  +
echo              +  ####       #####   ##     ##   ###     +
echo              +   ######   ### ###  ##   #####  #####   +
echo              +      ###  ######### ##     ##   ###     +
echo              +   ####   ###     ###  ######    ######  +
echo.
echo.
echo                  [NEXGEN TRANSMISSION TASK CREATED]
echo.
echo                    - 8:00PM
echo                    - 10:00PM
echo                    - START UP (Delayed 10 seconds)
echo.
echo.
echo.
timeout /t 5

cls


GOTO :start



====================================================================================
====================================================================================
====================================================================================

:Item_0NG

cls

GOTO :start









====================================================================================
====================================================================================
====================================================================================















:Item_6


echo off

:startCF

cls

Title "CARFAX"

cls

:startCF
                    

echo ===========================================================================
echo  :CARFAX:
echo ===========================================================================
echo   [PROGRAMS]
echo 1. CARFAX TRANSMIT              :    ####      ###      ######    ######  : 
echo 2. CARFAX LOYALTY               :  ####       #####   ##     ##   ###     :
echo 3. CARFAX TRANSMIT UPDATE       :   ######   ### ###  ##   #####  #####   :
echo.                                :      ###  ######### ##     ##   ###     :
echo   [DATABASES]                   :   ####   ###     ###  ######    ######  :
echo 4. TRANSMIT.SYS
echo 5. KEYVAL.SYS
echo 6. EXPORT SETTINGS
echo =============
echo 0. MAIN MENU                               
echo ===========================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%CF


====================================================================================
====================================================================================
====================================================================================



:Item_1CF

cls

start /w "" "C:\Program Files\QuickTouch\Data\CarFaxTransmitServer.exe"

cls

GOTO :startCF

====================================================================================
====================================================================================
====================================================================================


:Item_2CF

cls

start /w "" "C:\Program Files\QuickTouch\Data\CarFaxShopLoyalty.exe"

cls

GOTO :startCF

====================================================================================
====================================================================================
====================================================================================

:Item_3CF

cls

start /w "" "C:\Program Files\QuickTouch\Data\CarFaxTransmitUpdate.exe"

cls

GOTO :startCF


====================================================================================
====================================================================================
====================================================================================

:Item_4CF

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\Transmit.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startCF


====================================================================================
====================================================================================
====================================================================================

:Item_5CF

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\KeyVal.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startCF


====================================================================================
====================================================================================
====================================================================================

:Item_6CF

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\export.dat"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startCF


====================================================================================
====================================================================================
====================================================================================

:Item_0CF

cls

GOTO :start













====================================================================================
====================================================================================
====================================================================================











:Item_7


cls

IF EXIST "C:\Program Files\RDP Wrapper\RDPWInst.exe" (
    GOTO :startRDP
)


:INSTALLRDP
cls
@echo off
md "C:\Program Files\RDP Wrapper"

xcopy /e /v "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\RDPWRAP" "C:\Program Files\RDP Wrapper"


start /w "" "C:\Program Files\RDP Wrapper\INSTALL.lnk"


start /w "" "C:\Program Files\RDP Wrapper\AUTOUPDATE.lnk"

cls

@echo off

:startRDP

@echo off

cls

Title "RDP WRAPPER"

color F
echo =======================================================================
echo  :RDP WRAPPER:                   
echo =======================================================================
echo    [PROGRAMS]
echo 1. RDP CONFIGURATION        :    ####      ###      ######    ######  :
echo 2. RDP CHECK                :  ####       #####   ##     ##   ###     :
echo.                            :   ######   ### ###  ##   #####  #####   :
echo    [DATABASES]              :      ###  ######### ##     ##   ###     :
echo 3. RDP FILE LOCATION        :   ####   ###     ###  ######    ######  :
echo.
echo    [PROCESSES]
echo 4. RDP REINSTALLATION
echo 5. RDP UPDATE
echo 6. INI PROCESS
echo 7. ADD iPAD2 ACCOUNT
echo =======================
echo 0. MAIN MENU
echo 9. CLOSE
   ver
echo.
echo HOST COMPUTER IP ADDRESS
ipconfig | find /i "IPv4"
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%RDP

=======================================================================
=======================================================================
=======================================================================

:Item_1RDP

cls

"C:\Program Files\RDP Wrapper\RDPConf.exe" 
cls
echo ===============================================================================
echo =============================#######  #######(=================================
echo ============================######## #########  ##=============================
echo ===========================######## ######* #####   (==========================
echo ==========================########           ((((  ##==========================
echo ==========================#######     (((((((  ######==========================
echo =========================######## ((((((((  #######(===========================
echo ========================########          ########*============================
echo =======================########        ##########==============================
echo ======================######## ######## ######=================================
echo =====================*####### ###########======================================
echo ===============================================================================
echo ================+    ####      ###      ######    ######  +====================
echo ================+  ####       #####   ##     ##   ###     +====================
echo ================+   ######   ### ###  ##   #####  #####   +====================
echo ================+      ###  ######### ##     ##   ###     +====================
echo ================+   ####   ###     ###  ######    ######  +====================
echo ===============================================================================

cls

GOTO :startRDP


=======================================================================
=======================================================================
=======================================================================

:Item_2RDP

cls

"C:\Program Files\RDP Wrapper\RDPCheck.exe"
cls
echo ===============================================================================
echo =============================#######  #######(=================================
echo ============================######## #########  ##=============================
echo ===========================######## ######* #####   (==========================
echo ==========================########           ((((  ##==========================
echo ==========================#######     (((((((  ######==========================
echo =========================######## ((((((((  #######(===========================
echo ========================########          ########*============================
echo =======================########        ##########==============================
echo ======================######## ######## ######=================================
echo =====================*####### ###########======================================
echo ===============================================================================
echo ================+    ####      ###      ######    ######  +====================
echo ================+  ####       #####   ##     ##   ###     +====================
echo ================+   ######   ### ###  ##   #####  #####   +====================
echo ================+      ###  ######### ##     ##   ###     +====================
echo ================+   ####   ###     ###  ######    ######  +====================
echo ===============================================================================

cls

GOTO :startRDP


=======================================================================
=======================================================================
=======================================================================

:Item_3RDP

cls

explorer "C:\Program Files\RDP Wrapper\"

cls

GOTO :startRDP


=======================================================================
=======================================================================
=======================================================================


:Item_4RDP

cls

start /w "" "C:\Program Files\RDP Wrapper\re-install.bat"

cls


=======================================================================
=======================================================================
=======================================================================


:Item_5RDP

cls

COPY "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\RDPWRAP\AUTOUPDATE.lnk" "C:\Program Files\RDP Wrapper"

start /w "" "C:\Program Files\RDP Wrapper\AUTOUPDATE.lnk"

cls

GOTO :startRDP

cls

=======================================================================
=======================================================================
=======================================================================


:Item_6RDP

cls

net stop termservice /y

cls

explorer "C:\Program Files\RDP Wrapper\"

cls

*msg THE NEWEST .INI CAN NOW BE APPLIED

cls

echo THE NEWEST .INI CAN NOW BE APPLIED
echo.
echo CONTINUE WHEN .INI HAS BEEN REPLACED
pause

cls

net start termservice /y

cls

GOTO :startRDP


=======================================================================
=======================================================================
=======================================================================

:Item_7RDP

cls

ECHO Creating Users
setlocal
set NewAdmin=iPad2
set NewPassword=sage
set NewComment=Local Admin
net.exe user "%NewAdmin%" "%NewPassword%" /add /comment:"%NewComment%"
net.exe localgroup Administrators "%NewAdmin%" /add
wmic.exe useraccount WHERE "Name='%NewAdmin%'" SET PasswordExpires=FALSE

cls

GOTO :startRDP

====================================================================================
====================================================================================
====================================================================================


:Item_0RDP

cls

GOTO :start










====================================================================================
====================================================================================
====================================================================================




:Item_8

@echo off

Title "FOLDER DIRECTORIES"

cls

color F
echo =======================================================================
echo  :FOLDER DIRECTORIES:
echo =======================================================================
echo.
echo 1. DATA FOLDER              :    ####      ###      ######    ######  :
echo 2. QUICKTOUCH FOLDER        :  ####       #####   ##     ##   ###     :
echo 3. QUICKOUCH IPAD FOLDER    :   ######   ### ###  ##   #####  #####   :
echo 4. SAGEUTILITIES FOLDER     :      ###  ######### ##     ##   ###     :
echo 5. SAGETMP                  :   ####   ###     ###  ######    ######  :
echo 6. SHARED FOLDER
echo =================
echo 0. MAIN MENU
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%FD
====================================================================================

:Item_1FD

cls

explorer "C:\Program Files\QuickTouch\Data\"

cls

GOTO :start

====================================================================================

:Item_2FD

cls

explorer "C:\Program Files\QuickTouch\"

cls

GOTO :start

====================================================================================

:Item_3FD

cls

explorer "C:\Program Files\QuickTouchIpad\"

cls

GOTO :start

====================================================================================

:Item_4FD

cls

explorer "C:\SageUtilities\"

cls

GOTO :start

====================================================================================

:Item_5FD

cls

explorer "C:\Windows\SageTMP\"

cls

GOTO :start

====================================================================================

:Item_6FD

cls

explorer "C:\Program Files\QuickTouch\Data\shared"

cls

GOTO :start


====================================================================================

:Item_0FD

cls

GOTO :start





====================================================================================
====================================================================================
====================================================================================


:Item_9

@echo off

IF EXIST "C:\Program Files (x86)\QuickTouch MOTOR Updates\MOTORUpdate_2021_10_14\Deploy.exe" (
    GOTO :RUNMOTOR
) ELSE (
    GOTO :MOTOREXTRACT
)


:RUNMOTOR
cls
COPY "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\Databases\SSM\SSMDefinitions.sys" "C:\Program Files\QuickTouch\Data"
cls
@echo off
echo                                 +    ####      ###      ######    ######  +
echo [ SAGE MOTOR UPDATE FALL 2021 ] +  ####       #####   ##     ##   ###     +
echo [   INSTALLER NOW LAUNCHING   ] +   ######   ### ###  ##   #####  #####   +
echo                                 +      ###  ######### ##     ##   ###     +
echo                                 +   ####   ###     ###  ######    ######  +
echo.
echo.


start /w "" "C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\MOTOR_SC\MOTORUpdate_2021_10_14.lnk"
cls

start /w "" "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Tools\MOTOR2019_Patch.exe"

echo                                 +    ####      ###      ######    ######  +
echo [ SAGE MOTOR UPDATE FALL 2021 ] +  ####       #####   ##     ##   ###     +
echo      [   NOW INSTALLED   ]      +   ######   ### ###  ##   #####  #####   +
echo                                 +      ###  ######### ##     ##   ###     +
echo   [  LOADING TO MAIN MENU  ]    +   ####   ###     ###  ######    ######  +
echo.
echo.

timeout /t 10

cls

GOTO :Start



:MOTOREXTRACT
cls

echo                                 +    ####      ###      ######    ######  +
echo                                 +  ####       #####   ##     ##   ###     +
echo      [CONTINUE TO EXTRACT       +   ######   ### ###  ##   #####  #####   +
echo                                 +      ###  ######### ##     ##   ###     +
echo                                 +   ####   ###     ###  ######    ######  +
echo.
echo.




IF EXIST "C:\Users\%USERNAME%\Downloads\Motor Update Fall 2021.exe" (
    GOTO :RUNEXTRACT
) ELSE (
    goto :MOTORDOWNLOAD
)

:RUNEXTRACT

cmd.exe /c start "Motor Update Fall 2021" /Realtime /Affinity 0x1 "C:\Users\%USERNAME%\Downloads\Motor Update Fall 2021.exe"
wmic process where name="Motor Update Fall 2021.exe" CALL setpriority "Realtime"

cls

echo                                 +    ####      ###      ######    ######  +
echo                                 +  ####       #####   ##     ##   ###     +
echo   [CONTINUE WHEN EXTRACTION]    +   ######   ### ###  ##   #####  #####   +
echo         [IS COMPLETE]           +      ###  ######### ##     ##   ###     +
echo                                 +   ####   ###     ###  ######    ######  +
echo.
echo.

pause
GOTO :Item_10




:MOTORDOWNLOAD
@echo off

cls

echo ===============================================================================
echo ===============================================================================
echo ================+    ####      ###      ######    ######  +====================
echo ================+  ####       #####   ##     ##   ###     +====================
echo ================+   ######   ### ###  ##   #####  #####   +====================
echo ================+      ###  ######### ##     ##   ###     +====================
echo ================+   ####   ###     ###  ######    ######  +====================
echo ===============================================================================
echo ===============================================================================
echo ===========    THE DEFAULT BROWSER WILL NOW OPEN TO DOWNLOAD     ==============
echo ===============================================================================
echo ===========            THE MOST RECENT 'MOTOR UPDATE'            ==============
echo ===============================================================================
echo ===========  ONCE DOWNLOADED, CONTINUE THIS FUNCTION TO EXTRACT  ==============
echo ==============  OR RETURN TO MAIN MENU AND RERUN WHEN  ========================
echo ========================  DOWNLOAD IS COMPLETE  ===============================

start "" https://drb.app.box.com/s/uuagrlzpmdylurtvyzpj17ly8axpc1j2

echo =================   CONTINUE WHEN DOWNLOAD IS COMPLETE   ======================
echo ===============================================================================
echo ===============================================================================
@echo off

color F
echo 1. CONTINUE TO EXTRACTION                   	 
echo 0. MAIN MENU        

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%MI

:Item_1MI
cls
GOTO :Item_10
cls

:Item_0MI
cls
GOTO :start
cls






====================================================================================
====================================================================================
====================================================================================


:Item_10

@echo off
cls

:startQTA

Title "QUICKTOUCH ACTIVE"

color F
echo =======================================================================
echo  :QUICKTOUCH ACTIVE:
echo.
echo    [DATABASES]
echo 1. ACTIVESETTINGS.SYS       :    ####      ###      ######    ######  :
echo.                            :  ####       #####   ##     ##   ###     :
echo    [SERVICES]               :   ######   ### ###  ##   #####  #####   :
echo 2. RESTART QTA SERVICE      :      ###  ######### ##     ##   ###     :
echo 3. STOP QTA SERVICE         :   ####   ###     ###  ######    ######  :
echo.
echo    [PROCESSES]
echo 4. QTA INSTALLATION
echo =======================
echo 0. MAIN MENU
echo 6. CLOSE
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%QTA

=======================================================================
=======================================================================
=======================================================================

:Item_1QTA

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\Activesettings.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startQTA


=======================================================================
=======================================================================
=======================================================================

:Item_2QTA

cls

NET STOP QuickTouchActive

cls

NET START QuickTouchActive

cls

GOTO :startQTA


=======================================================================
=======================================================================
=======================================================================

:Item_3QTA

cls

NET STOP QuickTouchActive

cls

GOTO :startQTA


=======================================================================
=======================================================================
=======================================================================


:Item_4QTA

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls

xcopy /e /v "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\QTA" "C:\Program Files\QuickTouch\Data"

cls

msg * Enable .NET3.5 Features 

optionalfeatures

echo ======================================================
echo ===============[ QUICHTOUCH ACTIVE ]==================
echo ======================================================
echo ======================================================
echo ========  CONTINUE WHEN .NET3.5 IS INSTALLED  ========
echo ======================================================
pause

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\ActiveSettings.sys"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

msg * CONFIGURE QTA SETTINGS 

cls


echo ===============================================================
echo ===============================================================
echo =========+    ####      ###      ######    ######  +===========
echo =========+  ####       #####   ##     ##   ###     +===========
echo =========+   ######   ### ###  ##   #####  #####   +===========
echo =========+      ###  ######### ##     ##   ###     +===========
echo =========+   ####   ###     ###  ######    ######  +===========
echo ===============================================================
echo ===[ CONTINUE WHEN ACTIVESETTINGS INFORMATION IS COMPLETE  ]===
echo ===============================================================
echo ===============================================================
pause

cls

sc stop QuickTouchActive

sc delete QuickTouchActive

sc create QuickTouchActive binpath= "C:\Program Files\QuickTouch\Data\QuicktouchActiveService.exe" start= auto

net start QuickTouchActive

echo ===============================================================
echo ===============================================================
echo =========+    ####      ###      ######    ######  +===========
echo =========+  ####       #####   ##     ##   ###     +===========
echo =========+   ######   ### ###  ##   #####  #####   +===========
echo =========+      ###  ######### ##     ##   ###     +===========
echo =========+   ####   ###     ###  ######    ######  +===========
echo ===============================================================
echo ===========[ QUICKTOUCH ACTIVE IS NOW INSTALLED  ]=============
echo ===============================================================
echo ===============================================================
pause

cls

goto :startQTA


=======================================================================
=======================================================================
=======================================================================

:Item_0QTA

cls

GOTO :start


=======================================================================
=======================================================================
=======================================================================




:Item_11

:startAT

@echo off

Title "ADDITIONAL TOOLS"

cls

color F
echo =======================================================================
echo  :ADDITIONAL TOOLS:
echo =======================================================================
echo   [:TOOLS]
echo 1. AMS                      :    ####      ###      ######    ######  :
echo 2. MOTOR 2019 PATCH         :  ####       #####   ##     ##   ###     :
echo 3. BOMGAR                   :   ######   ### ###  ##   #####  #####   :
echo 4. MS ACCESS 97             :      ###  ######### ##     ##   ###     :
echo.                            :   ####   ###     ###  ######    ######  :
echo =========================
echo 5. SAGETECHTOOL UPDATE
echo =========================
echo 0. MAIN MENU
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%AT

================================

:Item_1AT

cls

:startAMS

Title "ACTIVE MANAGEMENT SERVICE"

color F
echo =======================================================================
echo  :ACTIVE MANAGEMENT SERVICE:
echo.
echo    [PROGRAMS]
echo 1. ACTIVE MANAGEMENT        :    ####      ###      ######    ######  :
echo.                            :  ####       #####   ##     ##   ###     :
echo    [SERVICES]               :   ######   ### ###  ##   #####  #####   :
echo 2. RESTART AMS SERVICE      :      ###  ######### ##     ##   ###     :
echo 3. STOP AMS SERVICE         :   ####   ###     ###  ######    ######  :
echo.
echo    [DATABASES]
echo 4. AGENTS.DAT
echo =======================
echo 5. MAIN MENU
echo 6. ADD. TOOLS MENU
echo 7. CLOSE
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%AMS

=======================================================================
=======================================================================
=======================================================================

:Item_1AMS

cls

"C:\Program Files\QuickTouch\ActiveManagementNotification.exe"

cls

GOTO :startAMS


=======================================================================
=======================================================================
=======================================================================

:Item_2AMS

cls

NET STOP SageAMS

cls

NET START SageAMS

cls

GOTO :startAMS


=======================================================================
=======================================================================
=======================================================================

:Item_3AMS

cls

NET STOP SageAMS

cls

GOTO :startAMS


=======================================================================
=======================================================================
=======================================================================

:Item_4AMS

@echo off
cls

IF EXIST "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" (
GOTO :MSTHR
) ELSE (
GOTO :MSNTHR
)

:MSNTHR
echo     +    ####      ###      ######    ######  +
echo     +  ####       #####   ##     ##   ###     +
echo     +   ######   ### ###  ##   #####  #####   +
echo     +      ###  ######### ##     ##   ###     +
echo     +   ####   ###     ###  ######    ######  +
ECHO.
ECHO.
ECHO      MICROSOFT ACCESS 97 MUST BE INSTALLED TO 
ECHO   "C:\Program Files (x86)\Microsoft Office\Office"
ECHO            FOR THIS PROCESS TO OPERATE
ECHO.
ECHO        MANUAL PROCESS WILL HAVE TO BE TAKEN

PAUSE 
cls

GOTO :START



:MSTHR

cls

cls

cmd.exe /c start "Access 97" /Realtime /Affinity 0x1 "C:\Program Files (x86)\Microsoft Office\Office\MSACCESS.EXE" "C:\Program Files\QuickTouch\Data\Agents.dat"
wmic process where name="MSACCESS.exe" CALL setpriority "Realtime"

cls

GOTO :startAMS


=======================================================================
=======================================================================
=======================================================================

:Item_5AMS

cls

GOTO :start

cls


=======================================================================
=======================================================================
=======================================================================

:Item_0AMS

cls

GOTO :startAT

=======================================================================
=======================================================================
=======================================================================






================================

:Item_2AT
cls
cmd.exe /c start "MOTOR2019_Patch" /Realtime /Affinity 0x1 "C:\Program Files\QuickTouch\Data\MOTOR2019_Patch.exe"
wmic process where name="BayInformation.exe" CALL setpriority "Realtime"
cls
GOTO :startAT

================================

:Item_3AT

cls
@echo off

Title "BOMGAR"

cls
@echo off
color F
echo =======================================================================
echo  :BOMGAR:
echo =======================================================================
echo.  
echo 1. INSTALL BOMGAR           :    ####      ###      ######    ######  :
echo.                            :  ####       #####   ##     ##   ###     :
echo 2. REINSTALL BOMGAR         :   ######   ### ###  ##   #####  #####   :
echo ====================        :      ###  ######### ##     ##   ###     :
echo 3. ADD.TOOLS MENU           :   ####   ###     ###  ######    ######  :
echo 0. MAIN MENU
echo =======================================================================

set /p x=Pick:
IF '%x%' == '%x%' GOTO Item_%x%BG
=======================================================================

:Item_1BG
cls
@echo off
IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working" RMDIR /s /q "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working"

cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\unbomgar.exe" DEL "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\unbomgar.exe"



cls

@echo off
echo "Extracting Bomgar"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\Bomgar" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs% 

cls

"C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working\BeyondTrustClientInstall.exe"
echo                                 +    ####      ###      ######    ######  +
echo                                 +  ####       #####   ##     ##   ###     +
echo    [RETURNING TO MAIN MENU]     +   ######   ### ###  ##   #####  #####   +
echo                                 +      ###  ######### ##     ##   ###     +
echo                                 +   ####   ###     ###  ######    ######  +
echo.
echo.

cls

GOTO :start

=======================================================================
=======================================================================
=======================================================================

:Item_2BG

cls

@echo off

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working" RMDIR /s /q "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working"

cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\unbomgar.exe" DEL "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\unbomgar.exe"



cls

@echo off
echo "Extracting Bomgar"
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\Bomgar" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs% 
cls

"C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\unbomgar.exe"

cls

"C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\Bomgar\Bomgar_Working\BeyondTrustClientInstall.exe"
echo                                 +    ####      ###      ######    ######  +
echo                                 +  ####       #####   ##     ##   ###     +
echo    [RETURNING TO MAIN MENU]     +   ######   ### ###  ##   #####  #####   +
echo                                 +      ###  ######### ##     ##   ###     +
echo                                 +   ####   ###     ###  ######    ######  +
echo.
echo.

cls

GOTO :start

=======================================================================
=======================================================================
=======================================================================

:Item_3BG

cls

GOTO :startAT

================================

:Item_0BG

cls

GOTO :start


================================

:Item_4AT
cls

IF EXIST "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\MSACCESS\ACCESS97\SETUP.EXE" (
GOTO :MSACCESSRUN
) ELSE (
GOTO :MSACCESSEXTRACT
)

cls

:MSACCESSEXTRACT
@echo off
setlocal
cd /d %~dp0
Call :UnZipFile "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\MSACCESS\ACCESS97" "C:\PROGRA~1\QuicktouchUtilities\QuicktouchUtilities\MSACCESS\Office97small.zip"
exit /b

:UnZipFile <ExtractTo> <newzipfile>
set vbs="%temp%\_.vbs"
if exist %vbs% del /f /q %vbs%
>%vbs%  echo Set fso = CreateObject("Scripting.FileSystemObject")
>>%vbs% echo If NOT fso.FolderExists(%1) Then
>>%vbs% echo fso.CreateFolder(%1)
>>%vbs% echo End If
>>%vbs% echo set objShell = CreateObject("Shell.Application")
>>%vbs% echo set FilesInZip=objShell.NameSpace(%2).items
>>%vbs% echo objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%vbs% echo Set fso = Nothing
>>%vbs% echo Set objShell = Nothing
cscript //nologo %vbs%
if exist %vbs% del /f /q %vbs% 
cls

:MSACCESSRUN
start /w "" "C:\Program Files\QuicktouchUtilities\QuicktouchUtilities\MSACCESS\ACCESS97\SETUP.EXE"


echo ===============================================================================
echo ===============================================================================
echo ================+    ####      ###      ######    ######  +====================
echo ================+  ####       #####   ##     ##   ###     +====================
echo ================+   ######   ### ###  ##   #####  #####   +====================
echo ================+      ###  ######### ##     ##   ###     +====================
echo ================+   ####   ###     ###  ######    ######  +====================
echo ===============================================================================
echo ===============================================================================
echo =====================[  CONTINUE WHEN 'MSACCESS IS  ]==========================
echo =============================[  INSTALLED  ]===================================
echo ===============================================================================
echo ===============================================================================
pause

cls

GOTO :startAT



================================
:Item_5AT

cls

"C:\SageUtilities\QuicktouchUtilities\QuicktouchUtilities\Scripts\SAGETECHTOOLUPDATE.bat"

cls

GOTO :start

================================
:Item_0AT

cls

GOTO :start












====================================================================================
====================================================================================
====================================================================================











:Item_12

cls

@echo off
echo ===============================================================================
echo ===============================================================================
echo =============================#######  #######(=================================
echo ============================######## #########  ##=============================
echo ===========================######## ######* #####   (==========================
echo ==========================########           ((((  ##==========================
echo ==========================#######     (((((((  ######==========================
echo =========================######## ((((((((  #######(===========================
echo ========================########          ########*============================
echo =======================########        ##########==============================
echo ======================######## ######## ######=================================
echo =====================*####### ###########======================================
echo ===============================================================================
echo ================+    ####      ###      ######    ######  +====================
echo ================+  ####       #####   ##     ##   ###     +====================
echo ================+   ######   ### ###  ##   #####  #####   +====================
echo ================+      ###  ######### ##     ##   ###     +====================
echo ================+   ####   ###     ###  ######    ######  +====================
echo ===============================================================================
echo ===============================================================================

"C:\Program Files\QuickTouch\sagepointofsale6.exe"
EXIT



=================================================================================
=================================================================================
=================================================================================


:Item_13

cls

EXIT


=================================================================================
=================================================================================
=================================================================================



:Item_00002

cls

@ECHO OFF

echo.
echo.
echo COPYING DATASET .ZIP TO DATASETS FOLDER
echo.
echo.

XCOPY "C:\Users\SagePOS\Desktop\DataExtraction\*.zip" "C:\ShopDatasets"
cls

echo.
echo.
echo DELETE .DAT FILES IN DATA FOLDER
echo.
echo.


DEL  "C:\Program Files\QuickTouch\Data\*.dat"
cls

echo.
echo.
echo DELETE GENSET.SYS IN DATA FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\GeneralSetup.sys"
cls

echo.
echo.
echo DELETE .HTML IN DATA FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\*.html"
cls

echo.
echo.
echo DELETE .JPG IN DATA FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\*.jpg
cls

echo.
echo.
echo DELETE .RTF IN DATA FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\*.rtf"
cls

echo.
echo.
echo DELETE .CSI IN DATA FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\shared\*.csi"
cls

echo.
echo.
echo DELETE SHARED FOLDER
echo.
echo.

DEL "C:\Program Files\QuickTouch\Data\shared" /f /q
cls

echo.
echo.
echo OPEN DATAEXTRACTION FOLDER
echo.
echo.

cd C:\Users\SagePOS\Desktop\DataExtraction
cls

echo.
echo.
echo EXTRACT .ZIP DATASET
echo.
echo.

"C:\Program Files\7-Zip\7zG.exe" e *.zip
cls

echo.
echo.
echo DELETE .ZIP IN DATAEXTRACTION
echo.
echo.

DEL "C:\Users\SagePOS\Desktop\DataExtraction\*.zip"
cls

echo.
echo.
echo COPY .CSI TO SHARED "DE" FOLDER 'IF EXIST'
echo.
echo.

COPY "C:\Users\SagePOS\Desktop\DataExtraction\*.csi" "C:\Users\SagePOS\Desktop\DataExtraction\shared"
cls

echo.
echo.
echo COPY 'DE' SHARED TO DATA/SHARED
echo.
echo.

XCOPY "C:\Users\SagePOS\Desktop\DataExtraction\shared" "C:\Program Files\QuickTouch\Data\shared" /K /D /H
cls

echo.
echo.
echo DELETE .CSI IN 'DE'
echo.
echo.

DEL "C:\Users\SagePOS\Desktop\DataExtraction\*.csi"
cls

echo.
echo.
echo COPY 'DE' DBs TO DATA
echo.
echo.

XCOPY "C:\Users\SagePOS\Desktop\DataExtraction\" "C:\Program Files\QuickTouch\Data" /K /D /H
cls

echo.
echo.
echo DELETE DBs IN 'DE'
echo.
echo.

DEL "C:\Users\SagePOS\Desktop\DataExtraction\*.*" /f /q
cls

echo.
echo.
echo DELETE 'DE'SHARED
echo.
echo.

rmdir /s /q C:\Users\SagePOS\Desktop\DataExtraction\shared\

cls

echo.
echo.
echo EXTRACTION COMPLETE
echo.
echo.

cls

GOTO :start








